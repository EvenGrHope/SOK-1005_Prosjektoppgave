<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="06">

<title>SOK-1005_Prosjektoppgave_V23_Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="SOK-1005_Prosjektoppgave_V23_Data_files/libs/clipboard/clipboard.min.js"></script>
<script src="SOK-1005_Prosjektoppgave_V23_Data_files/libs/quarto-html/quarto.js"></script>
<script src="SOK-1005_Prosjektoppgave_V23_Data_files/libs/quarto-html/popper.min.js"></script>
<script src="SOK-1005_Prosjektoppgave_V23_Data_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SOK-1005_Prosjektoppgave_V23_Data_files/libs/quarto-html/anchor.min.js"></script>
<link href="SOK-1005_Prosjektoppgave_V23_Data_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SOK-1005_Prosjektoppgave_V23_Data_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SOK-1005_Prosjektoppgave_V23_Data_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SOK-1005_Prosjektoppgave_V23_Data_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SOK-1005_Prosjektoppgave_V23_Data_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SOK-1005_Prosjektoppgave_V23_Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>06 </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="preparation" class="level2">
<h2 class="anchored" data-anchor-id="preparation">Preparation</h2>
<p>In this qmd file is the data wrangling part of my data project assignment for SOK-1005, V23.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clearing the environment.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading packages.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the code from the project description to get the assigned category.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>category <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Analgesics"</span>,<span class="st">"Bath Soap"</span>,<span class="st">"Beer"</span>,<span class="st">"Bottled Juices"</span>,<span class="st">"Cereals"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Cheeses"</span>,<span class="st">"Cigarettes"</span>,<span class="st">"Cookies"</span>,<span class="st">"Crackers"</span>,<span class="st">"Canned Soup"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Dish Detergent"</span>,<span class="st">"Front-end-candies"</span>,<span class="st">"Frozen Dinners"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Frozen Entrees"</span>,<span class="st">"Frozen Juices"</span>,<span class="st">"Fabric Softeners"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Grooming Products"</span>,<span class="st">"Laundry Detergents"</span>, <span class="st">"Oatmeal"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Paper Towels"</span>,<span class="st">"Soft Drinks"</span>,<span class="st">"Shampoos"</span>,<span class="st">"Snack Crackers"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Soaps"</span>,<span class="st">"Toothbrushes"</span>,<span class="st">"Canned Tuna"</span>,<span class="st">"Toothpastes"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Bathroom Tissues"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>letter2number <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">utf8ToInt</span>(x) <span class="sc">-</span> <span class="fu">utf8ToInt</span>(<span class="st">"A"</span>) <span class="sc">+</span> 1L}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>seed_number <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">letter2number</span>(<span class="st">"Even"</span>))</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(seed_number)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(category, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Frozen Dinners"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading in the data.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>demo           <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"Data_Files/Demographics.dta"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ccount         <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"Data_Files/Customer Count.dta"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>upc            <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data_Files/UPC Frozen Dinner.csv"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>movement       <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data_Files/Movement Frozen Dinner.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="upc---data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="upc---data-wrangling">UPC - Data wrangling</h2>
<p>The UPC file contain a description of each UPC in a category. The data is set up as follows:</p>
<ol type="1">
<li><p><strong>UPC</strong></p>
<p>The last five digits of the UPC number identify the product, the remaining digits identify the manufacturer.</p></li>
<li><p><strong>Commodity Code</strong></p>
<p>This is DFF’s version of categories. A single file can contain more than one commodity code. However, a single commodity code cannot be present in more than one UPC file.</p></li>
<li><p><strong>Item Code</strong></p>
<p>This variable tells us if the same product has multiple “generations” and if the item was warehoused or drop shipped.</p></li>
<li><p><strong>Description</strong></p>
<p>This is the products name and can contain certain characters that describes the data. In this instant we have a “~” symbol that symbolizes that it is a discontinued item.</p></li>
<li><p><strong>Case</strong></p>
<p>The number in this column is the amount of cases coming from the manufacturers.</p></li>
</ol>
<p>For a more detailed view of the variables, see the source.</p>
<p>Source: <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/dominicks-manual-and-codebook_kiltscenter">Dominick’s Data Manual</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing columns with irrelevant data and discontinued items.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>upc <span class="ot">&lt;-</span> upc <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>COM_CODE, <span class="sc">-</span>NITEM, <span class="sc">-</span>CASE, <span class="sc">-</span>SIZE) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(DESCRIP, <span class="st">"~"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a merged list with brands i want to work with, seperated by "|".</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>upc_brands <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"HLTHY"</span>, <span class="st">"BANQUET"</span>, <span class="st">"SWANSON"</span>, <span class="st">"SWAN"</span>, <span class="st">"LOONEY"</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">collapse =</span> <span class="st">"|"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Keeping only rows where "DESCRIP" matches the upc_brands and creating new column.</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>upc <span class="ot">&lt;-</span> upc <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(upc_brands, DESCRIP)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">BRAND =</span> <span class="fu">str_extract</span>(DESCRIP, upc_brands))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="movement---data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="movement---data-wrangling">Movement - Data wrangling</h2>
<p>The movement file contains sales information at the store level for each UPC in a category. The information is stored on a weekly basis. The data is set up as follows:</p>
<ol type="1">
<li><p><strong>UPC</strong></p>
<p>This is the key to use while merging with the UPC file.</p></li>
<li><p><strong>Price, Quantity and Movement</strong></p>
<p>The manufacturer will sometimes bundle products. In such occasion the quantity variable will indicate the size of the bundle. The price will reflect the total price of the bundle. The movement variable will reflect the number of actual items sold, not the number of bundles. Hence to compute the total dollar sales we must do the following: <span class="math inline">\(Sales = Price * Move / Qty\)</span></p></li>
<li><p><strong>Profit</strong></p>
<p>The profit variable indicates the gross margin in percent that DFF makes on the sales of the UPC. A profit of 25.3 means that DFF makes 25.3 cents on the dollar for each item sold. This yields a cost of good sold of 74.4 cents.</p></li>
<li><p><strong>Sales</strong></p>
<p>The sales variable indicates whether the product was sold on a promotion that week.</p></li>
<li><p><strong>OK</strong></p>
<p>This is a flag set to indicate that the data for that week are suspect.</p></li>
</ol>
<p>For a more detailed view of the variables, see the source.</p>
<p>Source: <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/dominicks-manual-and-codebook_kiltscenter">Dominick’s Data Manual</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing columns with irrelevant data.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>movement <span class="ot">&lt;-</span> movement <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(OK <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>PRICE_HEX, <span class="sc">-</span>PROFIT_HEX, <span class="sc">-</span>OK)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting weeks that correspond to 1993.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>movement <span class="ot">&lt;-</span> movement <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(WEEK <span class="sc">&gt;</span> <span class="dv">172</span> <span class="sc">&amp;</span> WEEK <span class="sc">&lt;</span> <span class="dv">226</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a new variable "SALES", containing total dollar sales and filtering &gt; 0.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>movement <span class="ot">&lt;-</span> movement <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SALES =</span> PRICE <span class="sc">*</span> MOVE<span class="sc">/</span>QTY) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SALES <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="upc-movement---merging" class="level2">
<h2 class="anchored" data-anchor-id="upc-movement---merging">UPC &amp; Movement - Merging</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging the UPC &amp; Movement data.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>upc_movement <span class="ot">&lt;-</span> <span class="fu">left_join</span>(upc, movement, <span class="at">by =</span> <span class="st">"UPC"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rearranging the data so its easier to look at. </span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>upc_movement <span class="ot">&lt;-</span> upc_movement <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(WEEK, <span class="at">.before =</span> UPC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="customer-count---data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="customer-count---data-wrangling">Customer Count - Data wrangling</h2>
<p>The customer count file includes information about in-store traffic. The data is store specific and on a daily basis. The customer count data refers to the number of customers visiting the store and purchasing something. Also in the customer count file is a total dollar sales and total coupons redeemed figure.</p>
<p>In this assignment we will only be using data from 1993 and the data will be aggregated too weekly observation. The customer count file has a lot of variables, see the source page 4, 5 and 6 for full overview.</p>
<p>Source: <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/dominicks-manual-and-codebook_kiltscenter">Dominick’s Data Manual</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing all na values.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ccount <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(ccount)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming the date column to date format.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ccount<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(ccount<span class="sc">$</span>date, <span class="st">"%y%m%d"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering for year 1993, same at the movement file.</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>ccount <span class="ot">&lt;-</span> ccount <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;</span> <span class="st">"1992-12-31"</span> <span class="sc">&amp;</span> date <span class="sc">&lt;</span> <span class="st">"1994-01-01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming store and week for the merge later.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ccount <span class="ot">&lt;-</span> ccount <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">STORE =</span> store, <span class="at">WEEK =</span> week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregating to weekly data.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ccount <span class="ot">&lt;-</span> ccount <span class="sc">%&gt;%</span>   </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(WEEK,STORE) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="at">.vars =</span> <span class="fu">c</span>(<span class="st">"grocery"</span>,<span class="st">"dairy"</span>,<span class="st">"frozen"</span>,<span class="st">"bottle"</span>,<span class="st">"mvpclub"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"groccoup"</span>,<span class="st">"meat"</span>,<span class="st">"meatfroz"</span>,<span class="st">"meatcoup"</span>,<span class="st">"fish"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"fishcoup"</span>, <span class="st">"promo"</span>,<span class="st">"promcoup"</span>, <span class="st">"produce"</span>, <span class="st">"bulk"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"saladbar"</span>,<span class="st">"prodcoup"</span>,<span class="st">"bulkcoup"</span>,<span class="st">"salcoup"</span>,<span class="st">"floral"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"florcoup"</span>, <span class="st">"deli"</span>, <span class="st">"deliself"</span>, <span class="st">"deliexpr"</span>,<span class="st">"convfood"</span>, </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"cheese"</span>,<span class="st">"delicoup"</span>,<span class="st">"bakery"</span>, <span class="st">"pharmacy"</span>, <span class="st">"pharcoup"</span>, </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"gm"</span>, <span class="st">"jewelry"</span>, <span class="st">"cosmetic"</span>,<span class="st">"haba"</span>,<span class="st">"gmcoup"</span>, <span class="st">"camera"</span>,  </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"photofin"</span>, <span class="st">"video"</span>, <span class="st">"videoren"</span>, <span class="st">"vidcoup"</span>, <span class="st">"beer"</span>, </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"wine"</span>, <span class="st">"spirits"</span>, <span class="st">"miscscp"</span>, <span class="st">"mancoup"</span>, <span class="st">"custcoun"</span>, </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ftgchin"</span>, <span class="st">"ftgccoup"</span>,<span class="st">"ftgital"</span>, <span class="st">"ftgicoup"</span>,<span class="st">"daircoup"</span>,</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"frozcoup"</span>, <span class="st">"habacoup"</span>, <span class="st">"photcoup"</span>, <span class="st">"cosmcoup"</span>, </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"ssdelicp"</span>, <span class="st">"bakcoup"</span>, <span class="st">"liqcoup"</span>), <span class="at">.funs =</span> sum) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="upc-movement-ccount---merging" class="level2">
<h2 class="anchored" data-anchor-id="upc-movement-ccount---merging">UPC, Movement &amp; CCount - Merging</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging UPC, Movement &amp; CCOunt files.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>upc_movement_ccount <span class="ot">&lt;-</span> <span class="fu">left_join</span>(upc_movement, ccount, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"WEEK"</span>, <span class="st">"STORE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="demographic---data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="demographic---data-wrangling">Demographic - Data wrangling</h2>
<p>The demographics file consists of store-specific demographic data. In the data there are a lot of variables, see the source page 7 and 8 for a full overview.</p>
<p>Source: <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/dominicks-manual-and-codebook_kiltscenter">Dominick’s Data Manual</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing columns with irrelevant data.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>gini, <span class="sc">-</span>name, <span class="sc">-</span>weekvol, <span class="sc">-</span>mmid)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Renaming STORE for the merge.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">STORE =</span> store)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="upc-movement-ccount-demo---merging" class="level2">
<h2 class="anchored" data-anchor-id="upc-movement-ccount-demo---merging">UPC, Movement, CCount &amp; Demo - Merging</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merging UPC, Movementm, CCount &amp; Demographics files.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Dataframe_Project <span class="ot">&lt;-</span> <span class="fu">left_join</span>(upc_movement_ccount, demo, <span class="at">by =</span> <span class="st">"STORE"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-final-file" class="level2">
<h2 class="anchored" data-anchor-id="creating-final-file">Creating final file</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Relocating.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>Dataframe_Project <span class="ot">&lt;-</span> Dataframe_Project <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(zip, <span class="at">.before =</span> STORE) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(lat, <span class="at">.before =</span> STORE) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(long, <span class="at">.before =</span> STORE)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Way to much data, selecting relevant columns.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>Dataframe_Project <span class="ot">&lt;-</span> Dataframe_Project[, <span class="dv">1</span><span class="sc">:</span><span class="dv">97</span>]</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>Dataframe_Project <span class="ot">&lt;-</span> Dataframe_Project[, <span class="sc">-</span><span class="dv">63</span><span class="sc">:-</span><span class="dv">69</span>]</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Rearranging the data so its easier to look at. </span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>Dataframe_Project <span class="ot">&lt;-</span> Dataframe_Project <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(city, <span class="at">.before =</span> MOVE) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(zone, <span class="at">.before =</span> MOVE) <span class="sc">%&gt;%</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(scluster, <span class="at">.before =</span> MOVE)</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Making weeks go from 1-52.</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>Dataframe_Project <span class="ot">&lt;-</span> Dataframe_Project <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">WEEK =</span> WEEK <span class="sc">-</span> <span class="dv">172</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a CSV file.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(Dataframe_Project, <span class="st">"Dataframe_Project.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="source" class="level2">
<h2 class="anchored" data-anchor-id="source">Source</h2>
<ul>
<li><p>James M. Kilts Center, University of Chicago Booth School of Business. (October, 2018). <em>Dominick’s Dataset.</em> <a href="https://www.chicagobooth.edu/research/kilts/datasets/dominicks" class="uri">https://www.chicagobooth.edu/research/kilts/datasets/dominicks</a></p></li>
<li><p>James M. Kilts Center, University of Chicago Booth School of Business. (October, 2018). <em>Dominick’s data manual.</em> <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/dominicks-manual-and-codebook_kiltscenter" class="uri">https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/dominicks-manual-and-codebook_kiltscenter</a></p></li>
<li><p>James M. Kilts Center, University of Chicago Booth School of Business. (October, 2018). <em>Frozen Dinners UPC.csv.</em> <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/upc_csv-files/upcfrd.csv">Download</a></p></li>
<li><p>James M. Kilts Center, University of Chicago Booth School of Business. (October, 2018). <em>Frozen Dinners Movement.csv.</em> <a href="https://www.chicagobooth.edu/-/media/enterprise/centers/kilts/datasets/dominicks-dataset/movement_csv-files/wfrd.zip">Download</a></p></li>
<li><p>James M. Kilts Center, University of Chicago Booth School of Business. (October, 2018). <em>Customer Count File.dta.</em> <a href="https://www.chicagobooth.edu/boothsitecore/docs/dff/store-demos-customer-count/ccount_stata.zip">Download</a></p></li>
<li><p>James M. Kilts Center, University of Chicago Booth School of Business. (October, 2018). <em>Demographics File.dta.</em> <a href="https://www.chicagobooth.edu/boothsitecore/docs/dff/store-demos-customer-count/demo_stata.zip">Download</a></p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>